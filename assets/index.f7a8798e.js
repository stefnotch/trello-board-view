import{r as e,a as t,o as a,c as l,d as r,e as s,b as o,w as i,p as c,f as n,g as d,F as h,h as u,t as p,i as v,j as m,k as f,l as g,T as b,m as x,n as y,q as w,s as k,u as C,v as I,x as B}from"./vendor.e243f91c.js";function S(){const{setCacheValue:r,getCacheValue:s}=function(){const e="local-cache/";return{setCacheValue:function(t,a,l=null){localStorage[e+t]=JSON.stringify({value:a,expiryDate:l})},getCacheValue:function(t){let a=localStorage[e+t];if(!a)return;let l=JSON.parse(a);return l.expiryDate&&l.expiryDate.getTime()>Date.now()?void 0:l.value}}}(),o=e({board:void 0,lists:[],cards:[],checklists:[],date:new Date}),i=t(""),c=t(s("trello-boards")||{NQjLXRCP:null});function n(e){let t=s(`trello-board/${e}`);return!(!t||!t.state)&&(o.board=t.state.board,o.lists=t.state.lists,o.cards=t.state.cards,o.checklists=t.state.checklists,o.date=t.state.date,!0)}const d=l((()=>o.lists.map((e=>({list:e,cards:o.cards.filter((t=>t.idList==e.id)).map((e=>{let t=o.checklists.filter((t=>t.idCard==e.id)),a=0,l=0;return t.forEach((e=>e.checkItems.forEach((e=>{a++,"complete"==e.state&&l++})))),{card:e,completionRate:a?l/a:0,itemsCount:a,itemsCompleted:l,checklists:t}}))}))))),h=l((()=>({board:o.board,lists:d.value})));return{boardId:i,trelloState:o,fetchBoard:async function(e){var t;i.value=e,o.board=void 0,o.lists=[],o.cards=[],o.checklists=[],o.date=new Date;try{let e=fetch(`https://api.trello.com/1/boards/${i.value}`).then((e=>e.json())).then((e=>o.board=e)),t=fetch(`https://api.trello.com/1/boards/${i.value}/lists`).then((e=>e.json())).then((e=>o.lists=e||[])),a=fetch(`https://api.trello.com/1/boards/${i.value}/cards`).then((e=>e.json())).then((e=>o.cards=e||[])),l=fetch(`https://api.trello.com/1/boards/${i.value}/checklists`).then((e=>e.json())).then((e=>o.checklists=e||[]));await Promise.allSettled([e,t,a,l])}catch(l){return console.warn(l),void n(i.value)}if(o.board){let l=null!=(t=s(`trello-board/${e}`))?t:{changes:[],state:o};l.changes.push(...a(l.state,o).map((e=>({change:e,date:new Date})))),l.state=o,r(`trello-board/${e}`,l),c.value[e]=null,r("trello-boards",c.value)}},tryLoadCachedBoard:n,cachedBoardIds:c,fullBoard:h}}!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const l=new URL(e,location),r=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,s)=>{const o=new URL(e,l);if(self[t].moduleMap[o])return a(self[t].moduleMap[o]);const i=new Blob([`import * as m from '${o}';`,`${t}.moduleMap['${o}']=m;`],{type:"text/javascript"}),c=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(i),onerror(){s(new Error(`Failed to import: ${e}`)),r(c)},onload(){a(self[t].moduleMap[o]),r(c)}});document.head.appendChild(c)})),self[t].moduleMap={}}}("/trello-board-view/assets/");var T=r({props:{icon:{type:String,required:!0},width:{type:[String,Number],default:18},height:{type:[String,Number],default:18},animation:{type:String,default:void 0},fill:{type:String,default:"inherit"}},setup(e,a){t();return{iconHtml:l((()=>s.icons[e.icon]?s.icons[e.icon].contents:void console.error(`Unknown icon ${e.icon}`)))}}});const L=i("data-v-25e492f8");c("data-v-25e492f8");const $={class:"eva-hover icon"};n();const M=L(((e,t,a,l,r,s)=>(d(),o("i",$,[(d(),o("svg",{xmlns:"http://www.w3.org/2000/svg",width:e.width,height:e.height,viewBox:"0 0 24 24",fill:e.fill,class:["eva eva-animation",`eva-icon-hover-${e.animation}`],innerHTML:e.iconHtml},null,10,["width","height","fill","innerHTML"]))]))));T.render=M,T.__scopeId="data-v-25e492f8";var P=r({props:{text:{type:String,required:!0},highlightText:{type:String,default:""}},setup:(e,t)=>({textParts:l((()=>{if(e.highlightText.length<=0)return[{text:e.text,isMatch:!1}];let t=e.text.toLowerCase(),a=e.highlightText.toLowerCase(),l=[],r=0;for(;;){let s=t.indexOf(a,r);if(-1==s)break;l.push({text:e.text.slice(r,s),isMatch:!1}),l.push({text:e.text.slice(s,s+a.length),isMatch:!0}),r=s+a.length}return l.push({text:e.text.slice(r,e.text.length),isMatch:!1}),l}))})});const _=i("data-v-5bfab5e7")(((e,t,a,l,r,s)=>(d(),o("span",null,[(d(!0),o(h,null,u(e.textParts,((e,t)=>(d(),o("span",{key:t,class:{highlight:e.isMatch}},p(e.text),3)))),128))]))));P.render=_,P.__scopeId="data-v-5bfab5e7";var j=r({props:{max:{type:Number,required:!0},value:{type:Number,required:!0},large:{type:Boolean,default:!1}},setup(e,t){const{max:a,value:r,large:s}=v(e),o=l((()=>(a?r.value/a.value*100:0)+"%"));return{max:a,value:r,large:s,percentage:o}}});const D=i("data-v-f992f64a")(((e,t,a,l,r,s)=>(d(),o("div",{class:["progress-bar",{large:e.large}]},[m("div",{class:"progress-bar-progress",style:{width:e.percentage}},null,4),e.large?(d(),o("div",{key:0,class:"progress-bar-text-white",style:{"clip-path":`polygon(0% 0%, ${e.percentage} 0%, ${e.percentage} 100%, 0% 100%)`}},p(e.value)+"/"+p(e.max),5)):f("",!0),e.large?(d(),o("div",{key:1,class:"progress-bar-text-black",style:{"clip-path":`polygon(100% 0%, ${e.percentage} 0%, ${e.percentage} 100%, 100% 100%)`}},p(e.value)+"/"+p(e.max),5)):f("",!0)],2))));j.render=D,j.__scopeId="data-v-f992f64a";var R=r({components:{EvaIcon:T,HighlightMatches:P,ProgressBar:j},props:{trelloBoard:{type:Object,required:!0},searchInput:{type:String,default:""}},setup(e,a){const{searchInput:r,trelloBoard:s}=v(e),{searchText:o,filteredBoard:i}=function(e,t){let a=l((()=>t.value.length>=2?t.value.toLowerCase():""));function r(e){return e.toLowerCase().includes(a.value)}const s=l((()=>e.value.lists.map((e=>({list:e.list,filteredCards:e.cards.map((e=>({card:e.card,fullCard:e,filteredDescription:r(e.card.desc)?e.card.desc:"",filteredChecklists:e.checklists.map((e=>({checklist:e,filteredCheckItems:e.checkItems.filter((e=>r(e.name)))}))).filter((e=>e.filteredCheckItems.length>0))}))).filter((e=>r(e.card.name)||!!e.filteredDescription||e.filteredChecklists.length>0))}))))),o=l((()=>({board:e.value.board,filteredLists:s.value})));return{searchInput:t,searchText:a,filteredBoard:o}}(s,r),c=t();return g((()=>{let e=document.querySelector("#app");e&&(c.value?e.style.filter="blur(2px)":e.style.filter="")})),{searchText:o,filteredBoard:i,openCard:c}}});const U=i("data-v-498ea24e");c("data-v-498ea24e");const N={class:"lists-container"},q={class:"open-card"},H={class:"list-item"},O={class:"labels"},V={class:"label-text"},E={class:"scrollbar-y"},F={class:"description"},J={key:0,class:"lists"},Q={class:"list-header"},X={class:"list-content-container"},z={class:"list-content"},A={class:"list-item"},G={class:"labels"},K={class:"label-text"},W={key:0,class:"search-matches"},Y={class:"description"},Z={key:1,class:"no-board"};n();const ee=U(((e,t,a,l,r,s)=>{const i=w("eva-icon"),c=w("progress-bar"),n=w("highlight-matches");return d(),o("div",N,[(d(),o(b,{to:"#popup-window"},[e.openCard?(d(),o("div",{key:0,class:"open-card-popup",onClick:t[2]||(t[2]=x((t=>e.openCard=void 0),["self"]))},[m("div",q,[m("div",H,[m(i,{class:"close-button",icon:"close",fill:"grey",width:24,height:24,onClick:t[1]||(t[1]=t=>e.openCard=void 0)}),m("div",null,[m("h3",null,[m("a",{href:e.openCard.card.url,class:"plain-link"},[y(p(e.openCard.card.name)+" ",1),m(i,{icon:"external-link",fill:"var(--foreground-highlight)"})],8,["href"])])]),m("div",O,[(d(!0),o(h,null,u(e.openCard.card.labels,(e=>(d(),o("span",{key:e.id,class:"label",style:{color:"yellow"!=e.color?e.color:"#5B5B00"}},[m("span",V,p(e.name),1)],4)))),128))]),m("div",E,[m("div",F,p(e.openCard.card.desc),1),(d(!0),o(h,null,u(e.openCard.checklists,(e=>(d(),o("div",{key:e.id},[m("h5",null,p(e.name),1),m("ul",null,[(d(!0),o(h,null,u(e.checkItems,(e=>(d(),o("li",{key:e.id,class:{completed:"complete"==e.state}},p(e.name),3)))),128))])])))),128))])]),m(c,{max:e.openCard.itemsCount,value:e.openCard.itemsCompleted,large:!0},null,8,["max","value"])])])):f("",!0)])),e.filteredBoard.board?(d(),o("div",J,[(d(!0),o(h,null,u(e.filteredBoard.filteredLists,(t=>(d(),o("div",{class:"list card",key:t.list.id},[m("h4",Q,p(t.list.name),1),m("div",X,[m("div",z,[(d(!0),o(h,null,u(t.filteredCards,(t=>(d(),o("div",{class:"card-small",key:t.card.id,onClick:a=>e.openCard=t.fullCard},[m("div",A,[m("div",null,[m(n,{text:t.card.name,highlightText:e.searchText},null,8,["text","highlightText"])]),m("div",G,[(d(!0),o(h,null,u(t.card.labels,(e=>(d(),o("span",{key:e.id,class:"label",style:{color:"yellow"!=e.color?e.color:"#5B5B00"}},[m("span",K,p(e.name),1)],4)))),128))]),e.searchText.length>=2?(d(),o("div",W,[m("div",Y,[m(n,{text:t.filteredDescription,highlightText:e.searchText},null,8,["text","highlightText"])]),(d(!0),o(h,null,u(t.filteredChecklists,(t=>(d(),o("div",{key:t.checklist.id},[m("h5",null,p(t.checklist.name),1),m("ul",null,[(d(!0),o(h,null,u(t.filteredCheckItems,(t=>(d(),o("li",{key:t.id,class:{completed:"complete"==t.state}},[m(n,{text:t.name,highlightText:e.searchText},null,8,["text","highlightText"])],2)))),128))])])))),128))])):f("",!0)]),m(c,{max:t.fullCard.itemsCount,value:t.fullCard.itemsCompleted},null,8,["max","value"])],8,["onClick"])))),128))])])])))),128))])):(d(),o("div",Z,"No board selected"))])}));R.render=ee,R.__scopeId="data-v-498ea24e";var te=r({components:{EvaIcon:T,HighlightMatches:P,TrelloBoard:R},setup(){var e,a;let l={getParam:function(e){return new URLSearchParams(window.location.search).get(e)},setParam:function(e,t){let a=new URLSearchParams(window.location.search);a.set(e,t),history.pushState(void 0,"",location.protocol+"//"+location.host+location.pathname+"?"+a+location.hash)}},r=t(null!=(e=l.getParam("board"))?e:"");const s=S();k(s.boardId,(e=>l.setParam("board",e))),!s.tryLoadCachedBoard(r.value)&&r.value&&s.fetchBoard(r.value);let o=t("");g((()=>document.title=o.value)),g((()=>o.value=s.trelloState.board?s.trelloState.board.name:""));const i=t(null!=(a=l.getParam("search"))?a:"");return k(i,(e=>l.setParam("search",e))),{searchInput:i,boardId:r,trello:s,trelloState:s.trelloState}}});const ae=i("data-v-2e74905f");c("data-v-2e74905f");const le={class:"container"},re={class:"header"},se=m("div",{class:"header-left"},[m("h2",null,[m("a",{href:"https://github.com/stefnotch/trello-board-view/",class:"plain-link"},"Trello Roadmap Viewer")]),m("span",null,"by Stefnotch")],-1),oe={class:"header-center"},ie={class:"card-small",style:{border:"3px solid white"}},ce={class:"inset-small"},ne={class:"search-bar"},de={class:"header-right"},he={class:"text-input-options-container"},ue={class:"text-input-options"},pe=m("div",null,[m("button",{class:"card-small history-button"},"Show History")],-1);n();const ve=ae(((e,t,a,l,r,s)=>{const i=w("eva-icon"),c=w("trello-board");return d(),o("div",le,[m("div",re,[se,m("div",oe,[m("div",ie,[m("div",ce,[m("label",ne,[m(i,{icon:"search",width:24,height:24,class:"search-bar-icon"}),C(m("input",{type:"text",class:"search-bar-input","onUpdate:modelValue":t[1]||(t[1]=t=>e.searchInput=t),autofocus:"",placeholder:"Search "+(e.trelloState.board&&e.boardId!=e.trello.boardId.value?"Cached ":"")+(e.trelloState.board?e.trelloState.board.name:"")},null,8,["placeholder"]),[[I,e.searchInput]])])])])]),m("div",de,[m("form",{class:"inset-small",onSubmit:t[3]||(t[3]=x((t=>e.trello.fetchBoard(e.boardId)),["prevent"]))},[C(m("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=t=>e.boardId=t),placeholder:"Board ID",class:"text-input"},null,512),[[I,e.boardId]]),m("button",{type:"submit",class:{"no-shadow":e.boardId==e.trello.boardId.value}},[m(i,{icon:e.boardId!=e.trello.boardId.value?"arrow-forward":"refresh",width:24,height:24,fill:e.boardId!=e.trello.boardId.value?"var(--foreground-highlight)":"black"},null,8,["icon","fill"])],2),m("div",he,[m("div",ue,[m("ul",null,[(d(!0),o(h,null,u(e.trello.cachedBoardIds.value,((t,a)=>(d(),o("li",{key:a,onMousedown:t=>{e.boardId=a,e.trello.fetchBoard(e.boardId)}},p(a),41,["onMousedown"])))),128))])])])],32)])]),pe,m(c,{trelloBoard:e.trello.fullBoard.value,searchInput:e.searchInput},null,8,["trelloBoard","searchInput"])])}));te.render=ve,te.__scopeId="data-v-2e74905f";B(te).mount("#app");
